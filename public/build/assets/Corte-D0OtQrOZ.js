import{Q as L,d as r,l as A,T as Q,o as s,c as z,w as V,a as e,e as l,t as o,g as h,F as _,h as p,f as m,u as g,m as w,v as G,p as B,q as H}from"./app-BcVz0gFs.js";import{_ as J}from"./AppLayout-BCxMC4vW.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";const K={class:"flex justify-between flex-col md:flex-row"},R={key:0},X={class:"text-xl font-bold"},Y={key:1},Z=e("h1",{class:"lg:text-2xl sm:text-xl font-bold"},"Corte de caja de sucursales",-1),ee={class:"text-lg"},te={class:"font-bold md:text-2xl px-2 py-1 rounded-lg"},se={class:"text-lg"},le={class:"font-bold md:text-2xl px-2 py-1 rounded-lg"},oe={key:2},ae={class:"font-bold px-2 py-1 rounded-lg"},de={key:0},ie={class:"text-lg my-3"},ne={class:"font-bold text-white md:text-2xl bg-green-500 px-2 py-1 rounded-lg"},re={class:"text-lg my-3"},ce={class:"font-bold text-white md:text-2xl bg-green-500 px-2 py-1 rounded-lg"},ue={class:"text-lg my-3"},_e={class:"font-bold text-white md:text-2xl bg-green-500 px-2 py-1 rounded-lg"},pe={class:"text-lg"},ve={class:"font-bold text-white md:text-2xl bg-teal-400 px-2 py-1 rounded-lg"},he={key:1,class:"flex flex-col items-center"},me={class:"flex flex-col md:flex-row items-center gap-4"},fe={class:"w-full gap-2 flex flex-col items-center"},xe=e("label",{for:"filter",class:"font-bold"},"Filtrar por:",-1),be={class:"flex gap-2"},ge=e("option",{value:"day"},"Día",-1),ye=e("option",{value:"week"},"Semana",-1),ke=e("option",{value:"month"},"Mes",-1),we=[ge,ye,ke],Te={key:0,class:"text-red-500 font-bold mt-2"},De={class:"py-4"},Fe={class:"max-w mx-auto sm:px-2 lg:px-4"},$e={class:"overflow-hidden sm:rounded-lg"},Be={key:0},je={class:"bg-white shadow-md rounded px-8 pt-6 pb-8 mb-4"},Me=e("h2",{class:"text-2xl text-gray-500 font-bold mb-5"},"Pedidos atendidos de hoy",-1),Ne={class:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4"},Se={class:"flex justify-between items-center"},Ce={key:0},Ee=e("p",{class:"font-bold mt-2"},"Marquesitas:",-1),Oe={class:"list-disc pl-5"},Ve={class:"list-disc pl-5"},qe={key:0},Ue={key:1},Pe=e("li",null,"Sencillas.",-1),We=[Pe],Ie={key:1},Le=e("p",{class:"font-bold mt-2"},"Bebidas:",-1),Ae={class:"list-disc pl-5"},Qe={key:1,class:"bg-white shadow-md rounded-xl px-8 pt-6 pb-8 mb-4"},ze={class:"grid grid-cols-1 sm:grid-cols-2 md:grid-cols-4 gap-3"},Ge={class:"text-center font-bold text-xl"},He={class:"mt-4"},Je={class:"font-bold"},Ke={key:0},Re=e("p",{class:"font-bold mt-2"},"Marquesitas:",-1),Xe={class:"list-disc pl-5"},Ye={class:"list-disc pl-5"},Ze={key:0},et={key:1},tt=e("li",null,"Sencillas.",-1),st=[tt],lt={key:1},ot=e("p",{class:"font-bold mt-2"},"Bebidas:",-1),at={class:"list-disc pl-5"},ct={__name:"Corte",setup(dt){const{props:d}=L(),j=r(d.totalEfectivo||0),q=r(d.totalTarjeta||0),M=r(d.totalTransferencia||0),N=r(d.totalBruto||0),T=r(d.ordens||[]),D=r(d.numeroDeOrdenes||0),F=r(d.hoy||""),S=r(d.sucursal||0),k=r(null),U=r(null),v=r(d.selectedFilter||"day"),f=r(d.selectedDate||""),x=r(d.selectedWeek||""),b=r(d.selectedMonth||""),C=r(d.numeroDeMarquesitas||0),E=r(d.bebidasCantidad||[]),P=A(()=>{if(S.value>0)return[];const u=T.value.reduce((t,a)=>{t[a.sucursal_id]||(t[a.sucursal_id]={id:a.sucursal_id,totalEfectivo:0,totalTarjeta:0,totalTransferencia:0,totalBruto:0,numeroDeOrdenes:0,ordens:[]});const i=parseFloat(a.total);if(!isNaN(i))switch(t[a.sucursal_id].totalBruto+=i,t[a.sucursal_id].numeroDeOrdenes+=1,t[a.sucursal_id].ordens.push(a),a.metodo){case"Efectivo":t[a.sucursal_id].totalEfectivo+=i;break;case"Tarjeta":t[a.sucursal_id].totalTarjeta+=i;break;case"Transferencia":t[a.sucursal_id].totalTransferencia+=i;break}return t},{});return Object.values(u).map(t=>(t.ordens.sort((a,i)=>a.id-i.id),t))}),$=Q({filter:v.value,value:b.value||x.value||f.value}),W=()=>{if(!f.value&&!x.value&&!b.value){k.value="Debe seleccionar una fecha.";return}let u="";switch(v.value){case"day":u=f.value;break;case"week":u=x.value;break;case"month":u=b.value;break}$.filter=v.value,$.value=u,$.get("/datos-filtrados",{onSuccess:n=>{j.value=n.props.totalEfectivo,q.value=n.props.totalTarjeta,M.value=n.props.totalTransferencia,N.value=n.props.totalBruto,T.value=n.props.ordens,C.value=n.props.numeroDeMarquesitas,D.value=n.props.numeroDeOrdenes,k.value="Debe seleccionar una fecha.",U.value="Filtrado por"},onError:n=>{console.error("Error al obtener datos filtrados:",n)}})},I=()=>{v.value="day",f.value="",x.value="",b.value="",contador.value=0,H.get("/corte")};return(u,n)=>(s(),z(J,{title:"Tablero"},{header:V(()=>[e("div",K,[e("div",null,[u.$page.props.auth.user.sucursal_id>0?(s(),l("div",R,[e("h1",X,"Corte de caja de sucursal "+o(S.value),1),e("p",null,"Corte del día "+o(F.value.split("T")[0].split("-")[2]+"/"+F.value.split("T")[0].split("-")[1]+"/"+F.value.split("T")[0].split("-")[0]),1)])):(s(),l("div",Y,[Z,e("p",ee,[h("Número de órdenes: "),e("span",te,o(D.value),1)])])),e("p",se,[h("Número de marquesitas: "),e("span",le,o(C.value),1)]),E.value?(s(),l("div",oe,[(s(!0),l(_,null,p(E.value,(t,a)=>(s(),l("p",{key:a,class:"text-lg"},[h("Número de "+o(a)+": ",1),e("span",ae,o(t),1)]))),128))])):m("",!0),e("span",null,o(g(d).selectedFilter==="day"?"Filtro por día: "+g(d).selectedDate.split("T")[0]:g(d).selectedFilter==="week"?"Filtro por semana: "+g(d).selectedWeek:g(d).selectedFilter==="month"?"Filtro por mes: "+g(d).selectedMonth.split("-").reverse().join("/"):""),1)]),u.$page.props.auth.user.sucursal_id>0?(s(),l("div",de,[e("p",ie,[h("Total en efectivo: "),e("span",ne,"$"+o(j.value),1)]),e("p",re,[h("Total por transferencia: "),e("span",ce,"$"+o(M.value),1)]),e("p",ue,[h("Total bruto: "),e("span",_e,"$"+o(N.value),1)]),e("p",pe,[h("Número de órdenes: "),e("span",ve,o(D.value),1)])])):(s(),l("div",he,[e("div",me,[e("div",fe,[xe,e("div",be,[w(e("select",{class:"ml-1 py-0 rounded",id:"filter","onUpdate:modelValue":n[0]||(n[0]=t=>v.value=t)},we,512),[[G,v.value]]),v.value==="day"?w((s(),l("input",{key:0,class:"w-fit h-fit p-1 rounded",id:"valueSelect",type:"date","onUpdate:modelValue":n[1]||(n[1]=t=>f.value=t)},null,512)),[[B,f.value]]):m("",!0),v.value==="week"?w((s(),l("input",{key:1,class:"w-fit h-fit p-1 rounded",id:"valueSelect",type:"week","onUpdate:modelValue":n[2]||(n[2]=t=>x.value=t)},null,512)),[[B,x.value]]):m("",!0),v.value==="month"?w((s(),l("input",{key:2,class:"w-fit h-fit p-1 rounded",id:"valueSelect",type:"month","onUpdate:modelValue":n[3]||(n[3]=t=>b.value=t)},null,512)),[[B,b.value]]):m("",!0)]),e("div",{class:"flex gap-1"},[e("button",{class:"text-sm rounded-lg shadow-lg disabled px-3 py-2 bg-blue-500 text-white hover:bg-blue-600",onClick:W},"Aplicar Filtro"),e("button",{class:"text-sm rounded-lg shadow-lg px-3 py-2 bg-gray-500 text-white hover:bg-gray-600",onClick:I}," Limpiar Filtro ")])])]),k.value?(s(),l("div",Te,o(k.value),1)):m("",!0)]))])]),default:V(()=>[e("div",De,[e("div",Fe,[e("div",$e,[u.$page.props.auth.user.sucursal_id>0?(s(),l("div",Be,[e("div",je,[Me,e("div",Ne,[(s(!0),l(_,null,p(T.value,(t,a)=>(s(),l("div",{key:t.id,class:"mb-4 shadow-xl bg-gray-100 p-4 rounded"},[e("div",Se,[e("p",null,"No. "+o(a+1)+" - "+o(t.nombre_comprador)+" - Total: $"+o(t.total),1)]),t.marquesitas&&t.marquesitas.length?(s(),l("div",Ce,[Ee,e("ul",Oe,[(s(!0),l(_,null,p(t.marquesitas,i=>{var c;return s(),l("li",{key:i.id},[h(" Precio: $"+o(i.precio_marquesita)+" ("+o(i.cantidad)+") ",1),e("ul",Ve,[((c=i.ingredientes)==null?void 0:c.length)>0?(s(),l("div",qe,[(s(!0),l(_,null,p(i.ingredientes,y=>(s(),l("li",{key:y.id}," Ingrediente: "+o(y.nombre),1))),128))])):(s(),l("div",Ue,We))])])}),128))])])):m("",!0),t.bebidas&&t.bebidas.length?(s(),l("div",Ie,[Le,e("ul",Ae,[(s(!0),l(_,null,p(t.bebidas,i=>(s(),l("li",{key:i.id},o(i.nombre)+" - $"+o(i.precio)+" ("+o(i.cantidad)+") ",1))),128))])])):m("",!0)]))),128))])])])):(s(),l("div",Qe,[e("div",ze,[(s(!0),l(_,null,p(P.value,t=>(s(),l("div",{key:t.id,class:"col-span-1 border rounded-2xl p-4"},[e("h1",Ge,"Sucursal "+o(t.id),1),e("p",null,"Total en efectivo: $"+o(t.totalEfectivo),1),e("p",null,"Total por transferencia: $"+o(t.totalTransferencia),1),e("p",null,"Total bruto: $"+o(t.totalBruto),1),e("p",null,"Número de órdenes: "+o(t.numeroDeOrdenes),1),e("div",He,[(s(!0),l(_,null,p(t.ordens,(a,i)=>(s(),l("div",{key:a.id,class:"mb-2"},[e("p",Je,">>"+o(i+1)+" - "+o(a.nombre_comprador)+" - Total: $"+o(a.total+"<<"),1),a.marquesitas&&a.marquesitas.length?(s(),l("div",Ke,[Re,e("ul",Xe,[(s(!0),l(_,null,p(a.marquesitas,c=>{var y;return s(),l("li",{key:c.id},[h(" Precio: $"+o(c.precio_marquesita)+" ("+o(c.cantidad)+") ",1),e("ul",Ye,[((y=c.ingredientes)==null?void 0:y.length)>0?(s(),l("div",Ze,[(s(!0),l(_,null,p(c.ingredientes,O=>(s(),l("li",{key:O.id}," Ingrediente: "+o(O.nombre),1))),128))])):(s(),l("div",et,st))])])}),128))])])):m("",!0),a.bebidas&&a.bebidas.length?(s(),l("div",lt,[ot,e("ul",at,[(s(!0),l(_,null,p(a.bebidas,c=>(s(),l("li",{key:c.id},o(c.nombre)+" - $"+o(c.precio)+" ("+o(c.cantidad)+") ",1))),128))])])):m("",!0)]))),128))])]))),128))])]))])])])]),_:1}))}};export{ct as default};
