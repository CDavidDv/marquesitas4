import{Q as S,d as b,o as u,c as U,w as C,a as e,e as p,F as V,h as D,m as n,p as i,t as _,f,q as h}from"./app-BcVz0gFs.js";import{_ as $}from"./AppLayout-BCxMC4vW.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";const N={class:"py-4"},B={class:"max-w mx-auto sm:px-2 lg:px-4"},F={class:"overflow-hidden sm:rounded-lg"},z={key:0},q={class:"bg-white shadow-md rounded px-8 pt-6 pb-8 mb-4"},A=e("h2",{class:"text-2xl text-gray-500 font-bold mb-5"},"Sucursales",-1),T={class:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4"},G={class:"flex flex-col overflow-x-scroll"},L={key:0,class:"flex flex-col"},M=["onUpdate:modelValue"],Q=["onUpdate:modelValue"],j=["onUpdate:modelValue"],H=["onUpdate:modelValue"],I=["onClick"],J=["onClick"],K={key:1},O=["onClick"],P=["onClick"],R=e("h2",{class:"text-2xl text-gray-500 font-bold mb-5"},"Añadir Nueva Sucursal",-1),W={class:"bg-gray-100 p-4 rounded shadow-md overflow-y-scroll"},X={class:"flex flex-col md:flex-row gap-3"},Y={key:0,class:"text-red-500 font-bold"},le={__name:"Sucursales",setup(Z){const{props:x}=S(),m=b(x.sucursales||[]),v=b(""),d=b(m.value.map(l=>({...l,email:l.user?l.user.email:"",password:"",isEditing:!1}))),a=b({nombre:"",direccion:"",email:"",password:""}),w=l=>{d.value[l].isEditing=!d.value[l].isEditing},y=l=>{const s=d.value[l];h.put(`/sucursales/${s.id}`,{nombre:s.nombre,direccion:s.direccion,email:s.email,password:s.password},{onSuccess:()=>{s.isEditing=!1,console.log("Sucursal y usuario actualizados con éxito")},onError:o=>{console.error("Error al actualizar la sucursal y usuario:",o)}})},E=()=>{if(a.value.direccion.trim()==""||a.value.email.trim()==""||a.value.nombre.trim()==""||a.value.password.trim()==""){v.value="Debe llenar todos los campos.";return}const{nombre:l,direccion:s,email:o,password:t}=a.value,r={nombre:l,direccion:s,email:o,password:t,isEditing:!1};a.value={nombre:"",direccion:"",email:"",password:""},v.value="",h.post(route("sucursales.store"),r,{onSuccess:c=>{console.log("Sucursal creada con éxito:",c.props),c.props&&c.props.sucursales?(m.value=c.props.sucursales,d.value=m.value.map(g=>({...g,email:g.user?g.user.email:"",password:"",isEditing:!1})),console.log("Sucursales actualizadas con los datos del servidor")):console.error("Datos de la respuesta no están en el formato esperado")},onError:c=>{console.error("Error al crear la sucursal:",c),d.value.pop()}})},k=l=>{const s=d.value[l];confirm(`¿Estás seguro de que deseas eliminar la sucursal ${s.nombre}?`)&&h.delete(route("sucursales.destroy",s.id),{onSuccess:()=>{m.value=m.value.filter((o,t)=>t!==l),d.value.splice(l,1),console.log("Sucursal y usuario eliminados con éxito")},onError:o=>{console.error("Error al eliminar la sucursal y usuario:",o)}})};return(l,s)=>(u(),U($,{title:"Tablero"},{default:C(()=>[e("div",N,[e("div",B,[e("div",F,[l.$page.props.auth.user.sucursal_id==0?(u(),p("div",z,[e("div",q,[A,e("div",T,[(u(!0),p(V,null,D(d.value,(o,t)=>(u(),p("div",{key:t,class:"mb-4 shadow-xl bg-gray-100 p-4 rounded"},[e("div",G,[o.isEditing?(u(),p("div",L,[n(e("input",{"onUpdate:modelValue":r=>o.nombre=r,class:"mb-2 p-2 border rounded",placeholder:"Nombre"},null,8,M),[[i,o.nombre]]),n(e("input",{"onUpdate:modelValue":r=>o.direccion=r,class:"mb-2 p-2 border rounded",placeholder:"Dirección"},null,8,Q),[[i,o.direccion]]),n(e("input",{"onUpdate:modelValue":r=>o.email=r,class:"mb-2 p-2 border rounded",placeholder:"Usuario"},null,8,j),[[i,o.email]]),n(e("input",{"onUpdate:modelValue":r=>o.password=r,type:"password",class:"mb-2 p-2 border rounded",placeholder:"Contraseña"},null,8,H),[[i,o.password]]),e("div",null,[e("button",{onClick:r=>y(t),class:"bg-blue-500 m-1 text-white px-2 py-1 rounded"},"Guardar",8,I),e("button",{onClick:r=>w(t),class:"bg-gray-500 text-white px-2 py-1 rounded"},"Cancelar",8,J)])])):(u(),p("div",K,[e("p",null,"Nombre: "+_(o.nombre),1),e("p",null,"Dirección: "+_(o.direccion),1),e("p",null,"Usuario: "+_(o.email),1),e("button",{onClick:r=>w(t),class:"bg-orange-500 m-1 text-white px-2 py-1 rounded"},"Editar",8,O),e("button",{onClick:r=>k(t),class:"bg-red-500 text-white px-2 py-1 rounded"},"Eliminar",8,P)]))])]))),128))]),R,e("div",W,[e("div",X,[n(e("input",{"onUpdate:modelValue":s[0]||(s[0]=o=>a.value.nombre=o),class:"mb-2 p-2 border rounded",placeholder:"Nombre"},null,512),[[i,a.value.nombre]]),n(e("input",{"onUpdate:modelValue":s[1]||(s[1]=o=>a.value.direccion=o),class:"mb-2 p-2 border rounded",placeholder:"Dirección"},null,512),[[i,a.value.direccion]]),n(e("input",{"onUpdate:modelValue":s[2]||(s[2]=o=>a.value.email=o),class:"mb-2 p-2 border rounded",placeholder:"Usuario"},null,512),[[i,a.value.email]]),n(e("input",{"onUpdate:modelValue":s[3]||(s[3]=o=>a.value.password=o),type:"password",class:"mb-2 p-2 border rounded",placeholder:"Contraseña"},null,512),[[i,a.value.password]])]),e("div",null,[v.value?(u(),p("div",Y,_(v.value),1)):f("",!0),e("button",{onClick:E,class:"bg-green-500 text-white px-4 py-2 rounded"},"Añadir")])])])])):f("",!0)])])])]),_:1}))}};export{le as default};
